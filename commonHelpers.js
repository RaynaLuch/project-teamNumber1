import{s as A}from"./assets/header-31508dc1.js";import{a as l,P as X,S as Y}from"./assets/vendor-cb0d5946.js";const d="/project-teamNumber1/assets/sprite-851c6254.svg";function M(t,e){const s=document.querySelector(".popular-product-list").querySelector(`[data-id="${t}"]`);if(!s||(e?s.classList.add("product-preview--in-cart"):s.classList.remove("product-preview--in-cart"),!s))return;s.children[1].children[0].children[1].children[0].children[0].setAttribute("href",`${d}#${e?"icon-check":"icon-cart"}`)}const $="basket";function O(t){const e=k();e.push(t),localStorage.setItem($,JSON.stringify(e)),A();try{M(t._id,!0)}catch{}}function E(t){return k().find(o=>o._id===t)}function k(){let t,e=localStorage.getItem($);return e?t=JSON.parse(e):t=[],t}function x(t){let e=k();e=e.filter(o=>o._id!==t),localStorage.setItem($,JSON.stringify(e)),A();try{M(t,!1)}catch{}}const Z="https://food-boutique.b.goit.study/api",B=document.querySelector("[data-modal-close]"),tt=document.querySelector("[data-modal]"),c=document.querySelector(".modal-cart-button");function N(){tt.classList.toggle("is-hidden")}const et=document.querySelector("#modal-img"),ot=document.querySelector("#modal-name"),st=document.querySelector("#modal-category"),rt=document.querySelector("#modal-size"),it=document.querySelector("#modal-popularity"),nt=document.querySelector("#modal-desc"),ct=document.querySelector("#modal-price");async function q(t){let e;try{let r=function(){c.removeEventListener("click",s),c.removeEventListener("click",o),B.removeEventListener("click",r),N()};e=await l(Z+"/products/"+t),console.log(e),et.src=e.data.img,ot.textContent=e.data.name,st.textContent=e.data.category,rt.textContent=e.data.size,it.textContent=e.data.popularity,nt.textContent=e.data.desc,ct.textContent="$"+e.data.price,N();const o=i=>{const n=e.data;x(n._id),c.removeEventListener("click",o),c.firstChild.textContent="Add to",c.addEventListener("click",s)},s=i=>{const n=e.data;O(n),c.removeEventListener("click",s),c.firstChild.textContent="Remove from",c.addEventListener("click",o)};E(e.data._id)?(c.firstChild.textContent="Remove from",c.addEventListener("click",o)):(c.firstChild.textContent="Add to",c.addEventListener("click",s)),B.addEventListener("click",r)}catch(o){console.log(o)}}const at=document.querySelector("[data-modal-close-shopping-cart]"),lt=document.querySelector("[data-modal-shopping-cart]");at.addEventListener("click",z);function z(){lt.classList.toggle("is-hidden")}const L=document.querySelector(".order-btn");L==null||L.addEventListener("click",()=>z());function dt(t){const e=`<ul class="card-container-list">${t.map(o=>{const s=o.category.split("_").join(" ");return`
      <li class="photo-card-list">
        <a class="product-modal-list" href="#">
          <div class="img-container-list">
            <img class="product-image-list" src="${o.img}" alt="${o.name} photo" width=140 height=140 loading="lazy" />
          </div>

          <div class="product-info-list">
            <h3 class="product-name-list">${o.name}</h3>
            <div class="product-atributes-list">
              <p class="atributes-info-list">
                <span class="atributes-list">Category:</span> ${s}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Size:</span> ${o.size}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Popularity:</span> ${o.popularity}
              </p>
            </div>
          </div>
        </a>
        <div class="price-and-btn-list">
          <p class="product-price-list">$${o.price}</p>
          <button class="cart-btn-list" type="button" data-product-id="${o._id}">
            <svg class="list-cart-svg-list" width="18" height="18">
              <use href="${d}#icon-white-basket"></use>
            </svg>
          </button>
        </div> 
      </li>
  `}).join("")}</ul>`;return setTimeout(()=>{document.querySelectorAll(".cart-btn-list").forEach(o=>{o.addEventListener("click",s=>{const r=s.currentTarget.dataset.productId,i=t.find(n=>n._id===r);i?handleCartButtonClick(i,t):console.error("Product not found by ID:",r)})})},0),J(t),e}function J(t){document.querySelectorAll(".cart-btn-list").forEach(e=>{e.addEventListener("click",o=>{const s=o.currentTarget.dataset.productId;handleCartButtonClick(s,t)})})}function ut(){const t=pt();document.querySelectorAll(".cart-btn-list").forEach(e=>{const o=e.dataset.productId;t.find(r=>r._id===o)?e.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${d}#icon-check"></use>
        </svg>
      `:e.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${d}#icon-white-basket"></use>
        </svg>
      `})}function pt(){const t=localStorage.getItem("shoppingCart");return t?JSON.parse(t):[]}const mt=document.querySelector(".products-container");mt.addEventListener("click",gt);function gt(t){t.preventDefault(),t.target.nodeName==="LI"&&q(item._id)}window.onscroll=function(){ft()};function ft(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}const yt=document.getElementById("products-container");let y,H=window.innerWidth<768?2:4;function ht(t,e){return l.get("https://food-boutique.b.goit.study/api/products",{params:{page:t,limit:e}})}function b(){const t=localStorage.getItem("productFilters");return t?JSON.parse(t):{keyword:null,category:null,page:1,limit:6}}function vt(t){localStorage.setItem("productFilters",JSON.stringify(t))}function C(t,e){const o=b();o[t]=e,vt(o)}window.addEventListener("resize",bt);function bt(){let t;window.innerWidth>=1440?t=9:window.innerWidth>=768?t=8:t=6,b().limit!==t&&(C("limit",t),H=window.innerWidth<768?2:4,I())}async function I(){const t=b();let e=t.page||1,o=t.limit||6;try{const{data:s}=await ht(e,o),{perPage:r,totalPages:i,results:n}=s,h=r*i;yt.innerHTML=dt(n),J(n);const w=document.getElementById("tui-pagination-container");y?(y.reset(h),y.movePageTo(e)):(y=new X(w,{totalItems:h,itemsPerPage:o,visiblePages:H,centerAlign:!0,page:e}),y.on("beforeMove",u=>{const g=u.page,f=b(),F=f.limit||6;(g!==f.page||F!==f.limit)&&(C("page",g),C("limit",F),I())})),ut()}catch(s){console.error("Error fetching products",s)}}I();const St=document.querySelector(".carts-discount");j();async function j(){const{data:t}=await l.get("https://food-boutique.b.goit.study/api/products/discount");return t.sort(()=>Math.random()-.5).slice(0,2)}wt();async function wt(){const e=(await j()).map(({img:n,is10PercentOff:h,price:w,name:u,_id:g})=>{const f=u.split("").slice(0,11).join("")+"...";return`<li data-id="${g}"class="dis-product-card"><img class="dis-product-img" src="${n}" alt="${u}"/><div class="dis-card-description"><p class="dis-card-name">${u.split("").length>11?f:u}</p><div class="price-btn-list">
        <p class="product-price-list">$${w}</p>
        <button class="cart-btn-list" type="button" data-product-id="${g}">
          <svg class="list-cart-svg-list" width="18" height="18">
            <use href="${d}#icon-white-basket"></use>
          </svg>
        </button>
      </div></div></div>${h?`<svg class="discount-icon"><use href="${d}#icon-discount"></use></svg>`:null}</li>`}).join(""),o=document.createElement("div");o.classList.add("dis-container");const s=document.createElement("h2");s.classList.add("discount-title"),s.innerText="Discount products";const r=document.createElement("ul");r.classList.add("discount-list"),r.innerHTML=e,o.append(s),o.append(r),document.createElement("svg"),r.querySelectorAll(".dis-product-card").forEach(n=>{n.addEventListener("click",()=>{q(n.dataset.id)})}),St.append(o)}const v=JSON.parse(localStorage.getItem("userEmailsArray"))||[],D=document.querySelector(".footer-form"),R=document.querySelector(".wrong-email-footer"),W=document.querySelector(".footer-modal-w-success"),U=document.querySelector(".footer-modal-w-failure"),p=D.querySelector("input[type=email]"),Lt=D.querySelector("button[type=submit]"),Et=document.querySelector(".footer-close-success-margin"),Ct=document.querySelector(".footer-close-failure-margin"),$t=document.querySelector(".footer-close-email-margin"),m=document.querySelector(".modal-section"),kt=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);Lt.addEventListener("click",function(t){t.preventDefault();const e=p.value;if(!kt(e)){p.value="",R.classList.add("visibility"),m.classList.add("modal-subscribing-footer");return}It()});const qt=()=>{const t=p.value;v.includes(t)?(p.value="",U.classList.add("visibility"),m.classList.add("modal-subscribing-footer")):(v.push(t),console.log("Users who have already subscribed:",v),localStorage.setItem("userEmailsArray",JSON.stringify(v)))},It=async()=>{try{const t="https://food-boutique.b.goit.study/api/subscription";qt();const e={email:`${p.value}`},o=await l.post(t,e);W.classList.add("visibility"),m.classList.add("modal-subscribing-footer"),p.value=""}catch(t){console.error("Error sending request:",t.message)}};Ct.addEventListener("click",function(t){m.classList.remove("modal-subscribing-footer"),U.classList.remove("visibility")});$t.addEventListener("click",function(t){m.classList.remove("modal-subscribing-footer"),R.classList.remove("visibility")});Et.addEventListener("click",function(t){m.classList.remove("modal-subscribing-footer"),W.classList.remove("visibility")});const T=document.querySelector(".footer-modal-w-img"),Pt=768;function G(){window.innerWidth<=Pt?T.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle-mobile.png?raw=true":T.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle.png?raw=true"}G();window.addEventListener("resize",G);const _t="https://food-boutique.b.goit.study/api/products/popular",V=document.querySelector(".carts-popular"),P=document.createElement("h2");P.classList.add("popular-product-title");P.textContent="Popular products";V.appendChild(P);const _=document.createElement("ul");_.classList.add("popular-product-list");V.appendChild(_);function Ft(t){if(!t)return console.error("Помилка"),null;const e=E(t._id),o=document.createElement("li");o.classList.add("product-preview"),o.setAttribute("data-id",t._id),e?o.classList.add("product-preview--in-cart"):o.classList.remove("product-preview--in-cart");const s=document.createElement("button");return s.onclick=r=>{r.stopPropagation(),E(t._id)?x(t._id):O(t)},s.className="product-preview__cart-btn",s.innerHTML=`
    <svg>
      <use href="${d}#${e?"icon-check":"icon-cart"}">
      </use>
    </svg>`,o.innerHTML=`
    <div class="product-preview__image-container">
      <img src="${t.img}" alt="${t.name}">
    </div>
    <div class="product-preview__info">
      <div class="product-preview__heading-wrapper">
        <h2 class="product-preview__heading">${t.name}</h2>
      </div>
      <div class="product-preview__description">
        <p class="product-preview__category"><span class="product-preview__sub-heading">Category:</span> ${t.category}</p>
        <p><span class="product-preview__sub-heading">Size:</span> ${t.size}</p>
        <p><span class="product-preview__sub-heading">Popularity:</span> ${t.popularity}</p>
      </div>
    </div>
  `,o.children[1].children[0].appendChild(s),o.onclick=()=>{q(t._id)},o}async function Bt(){try{return(await l.get(_t)).data}catch(t){throw console.error("Помилка при отриманні даних: ",t),t}}document.addEventListener("DOMContentLoaded",async()=>{try{const t=await Bt();console.log(t),t.sort((e,o)=>o.popularity-e.popularity).forEach(e=>{const o=Ft(e);o&&_.appendChild(o)})}catch(t){console.error("Помилка при отриманні даних: ",t)}});const K=document.querySelector(".filters-select"),Nt=document.querySelector(".filtersInput"),Tt=document.querySelector(".filtersBtn");let S;const a={keyword:null,category:null,page:1,limit:9};localStorage.setItem("filterParams",JSON.stringify(a));async function At(){try{return(await l.get("https://food-boutique.b.goit.study/api/products/categories")).data}catch(t){throw console.log("Проблема при запросе на сервер"),new Error(t)}}async function Q(t){const{keyword:e,category:o,page:s,limit:r}=t;try{let i;return e===null&&o===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?page=${s}&limit=${r}`):e===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?category=${o}&page=${s}&limit=${r}`):o===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?keyword=${e}&page=${s}&limit=${r}`):i=await l.get(`https://food-boutique.b.goit.study/api/products?keyword=${e}&category=${o}&page=${s}&limit=${r}`),i.data.results}catch(i){throw console.log("Помилка на сервері при пошуку продуктів",i),new Error(i)}}async function Mt(){try{const e=(await At()).map(o=>`<option>${o}</option>`).join("")+"<option>Show all</option>";K.insertAdjacentHTML("beforeend",e),new Y({select:".filters-select"})}catch(t){console.log("Проблема при обработке данных с сервера",t)}}Mt();K.addEventListener("change",Ot);Tt.addEventListener("click",xt);async function Ot(t){a.category=t.currentTarget.value,a.category==="Show all"?a.category=null:localStorage.setItem("filterParams",JSON.stringify(a)),S=await Q(a),console.log(S)}async function xt(){const t=Nt.value;t.trim()?a.keyword=t:a.keyword=null,localStorage.setItem("filterParams",JSON.stringify(a)),S=await Q(a),console.log(S)}
//# sourceMappingURL=commonHelpers.js.map
