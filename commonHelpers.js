import{r as T,a as S,f as w,i as f}from"./assets/manage-cart-52b4aebc.js";import{a as l,S as ot,P as st}from"./assets/vendor-cb0d5946.js";const nt="https://food-boutique.b.goit.study/api",k=document.querySelector("[data-modal-close]"),it=document.querySelector("[data-modal]"),r=document.querySelector(".modal-cart-button");function $(){it.classList.toggle("is-hidden")}const z=document.querySelector("#modal-img"),j=document.querySelector("#modal-name"),rt=document.querySelector("#modal-category"),ct=document.querySelector("#modal-size"),at=document.querySelector("#modal-popularity"),lt=document.querySelector("#modal-desc"),dt=document.querySelector("#modal-price");async function B(t){let o;try{let n=function(){r.removeEventListener("click",s),r.removeEventListener("click",e),k.removeEventListener("click",n),document.removeEventListener("keyup",i),$()},i=function(c){c.keyCode===27&&($(),r.removeEventListener("click",s),r.removeEventListener("click",e),document.removeEventListener("keyup",i),k.removeEventListener("click",n))};o=await l(nt+"/products/"+t),console.log(o),z.src=o.data.img,j.textContent=o.data.name,z.alt=j.textContent,rt.textContent=o.data.category,ct.textContent=o.data.size,at.textContent=o.data.popularity,lt.textContent=o.data.desc,dt.textContent="$"+o.data.price,$();const e=c=>{const a=o.data;T(a._id),r.removeEventListener("click",e),r.firstChild.textContent="Add to",r.addEventListener("click",s)},s=c=>{const a=o.data;S(a),r.removeEventListener("click",s),r.firstChild.textContent="Remove from",r.addEventListener("click",e)};w(o.data._id)?(r.firstChild.textContent="Remove from",r.addEventListener("click",e)):(r.firstChild.textContent="Add to",r.addEventListener("click",s)),k.addEventListener("click",n),document.addEventListener("keyup",i)}catch(e){console.log(e)}}const q=document.querySelector("[data-modal-close-shopping-cart]"),g=document.querySelector("[data-modal-shopping-cart]");q==null||q.addEventListener("click",A);function A(){g.classList.toggle("is-hidden")}const C=document.querySelector(".order-btn");C==null||C.addEventListener("click",()=>A());g==null||g.addEventListener("keypress",O);function O(t){t.keyCode===27&&(A(),g==null||g.removeEventListener("keypress",O))}function ut(t){return`<ul class="card-container-list">${t.map(e=>{const s=e.category.split("_").join(" ");return`
      <li class="photo-card-list" data-id="${e._id}">
        <a class="product-modal-list" href="#">
          <div class="img-container-list">
            <img class="product-image-list" src="${e.img}" alt="${e.name} photo" width=140 height=140 loading="lazy" />
          </div>

          <div class="product-info-list">
            <h3 class="product-name-list">${e.name}</h3>
            <div class="product-atributes-list">
              <p class="atributes-info-list">
                <span class="atributes-list">Category:</span> ${s}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Size:</span> ${e.size}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Popularity:</span> ${e.popularity}
              </p>
            </div>
          </div>
        </a>
        <div class="price-and-btn-list">
          <p class="product-price-list">$${e.price}</p>
          <button class="cart-btn-list" type="button" data-product-id="${e._id}">
            <svg class="list-cart-svg-list" width="18" height="18">
              <use href="${f}#icon-white-basket"></use>
            </svg>
          </button>
        </div> 
      </li>
  `}).join("")}</ul>`}function pt(t){document.querySelectorAll(".cart-btn-list").forEach(o=>{o.addEventListener("click",e=>{e.stopPropagation();const s=e.currentTarget.dataset.productId,n=t.find(c=>c._id===s);w(s)?(T(s),_(s)):(S(n),_(s))})})}function _(t){const o=document.querySelector(`[data-product-id='${t}']`);if(!o)return;w(t)?o.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${f}#icon-check"></use>
        </svg>
      `:o.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${f}#icon-white-basket"></use>
        </svg>
      `}function mt(){document.querySelectorAll(".photo-card-list").forEach(o=>{o.addEventListener("click",e=>{e.preventDefault(),B(o.dataset.id)})})}const P=document.querySelector("#myBtn");function R(){document.body.scrollTop>20||document.documentElement.scrollTop>20?P.style.display="block":P.style.display="none",P.addEventListener("click",gt)}function gt(){window.scroll({top:0,left:0,behavior:"smooth"})}window.onscroll=R;window.onload=R;const U="productFilters",W=document.querySelector(".filters-select"),J=document.querySelector(".filtersInput"),ft=document.querySelector(".filtersBtn");let F;document.getElementById("products-container");function p(){const t=localStorage.getItem(U);return t?JSON.parse(t):{keyword:null,category:null,page:1,limit:6}}function M(t){localStorage.setItem(U,JSON.stringify(t))}async function vt(){try{return(await l.get("https://food-boutique.b.goit.study/api/products/categories")).data}catch(t){throw console.log("Проблема при запросе на сервер"),new Error(t)}}async function G(t){const{keyword:o,category:e,page:s,limit:n}=t;try{let i;return o===null&&e===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?page=${s}&limit=${n}`):o===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?category=${e}&page=${s}&limit=${n}`):e===null?i=await l.get(`https://food-boutique.b.goit.study/api/products?keyword=${o}&page=${s}&limit=${n}`):i=await l.get(`https://food-boutique.b.goit.study/api/products?keyword=${o}&category=${e}&page=${s}&limit=${n}`),i}catch(i){throw console.log("Помилка на сервері при пошуку продуктів",i),new Error(i)}}async function yt(){try{const o=(await vt()).map(n=>`<option>${n}</option>`).join("")+"<option>Show all</option>";W.insertAdjacentHTML("beforeend",o);const e=new ot({select:".filters-select"}),s=p();J.value=s.keyword,e.setSelected(s.category)}catch(t){console.log("Проблема при обработке данных с сервера",t)}}yt();W.addEventListener("change",ht);ft.addEventListener("click",bt);async function ht(t){const o=t.currentTarget.value,e=p();o==="Show all"||o==="Categories"?e.category=null:e.category=o,M(e),F=await G(e),L(),console.log(F.data.results)}async function bt(){const t=J.value,o=p();t.trim()?o.keyword=t:o.keyword=null,M(o),L(),console.log(F.data.results)}async function wt(){const t=p();return console.log("filters",t),await G(t)}const Lt=document.getElementById("products-container");let b,V=window.innerWidth<768?2:4;function Et(t,o){return wt()}function I(t,o){const e=p();e[t]=o,M(e)}window.addEventListener("resize",St);function St(){let t;window.innerWidth>=1440?t=9:window.innerWidth>=768?t=8:t=6,p().limit!==t&&(I("limit",t),V=window.innerWidth<768?2:4,L())}async function L(){const t=p();let o=t.page||1,e=t.limit||6;try{const{data:s}=await Et(o,e),{perPage:n,totalPages:i,results:c}=s,a=n*i;Lt.innerHTML=ut(c),pt(c),mt();const d=document.getElementById("tui-pagination-container");i>1?(b?(b.reset(a),b.movePageTo(o)):(b=new st(d,{totalItems:a,itemsPerPage:e,visiblePages:V,centerAlign:!0,page:o}),b.on("beforeMove",u=>{const m=u.page,h=p(),N=h.limit||6;(m!==h.page||N!==h.limit)&&(I("page",m),I("limit",N),L())})),_()):d.innerHTML=""}catch(s){console.error("Error fetching products",s)}}L();const K=document.querySelector(".carts-discount");async function kt(){const{data:t}=await l.get("https://food-boutique.b.goit.study/api/products/discount");return t.sort(()=>Math.random()-.5).slice(0,2)}$t();async function $t(){const t=await kt(),o=t.map(({img:c,is10PercentOff:a,price:d,name:u,_id:m})=>{const h=u.split("").slice(0,11).join("")+"...";return`<li data-id="${m}"class="dis-product-card"><img class="dis-product-img" src="${c}" alt="${u}"/><div class="dis-card-description"><p class="dis-card-name">${u.split("").length>11?h:u}</p><div class="price-btn-list">
        <p class="product-price-list">$${d}</p>
        <button class="cart-btn-list" type="button" data-product-id="${m}">
          <svg class="list-cart-svg-list" width="18" height="18">
            <use href="${f}#icon-white-basket"></use>
          </svg></button>
      </div></div></div>${a?`<svg class="discount-icon"><use href="${f}#icon-discount"></use></svg>`:null}</li>`}).join(""),e=document.createElement("div");e.classList.add("dis-container");const s=document.createElement("h2");s.classList.add("discount-title"),s.innerText="Discount products";const n=document.createElement("ul");n.classList.add("discount-list"),n.innerHTML=o,e.append(s),e.append(n),n.querySelectorAll(".dis-product-card").forEach(c=>{c.addEventListener("click",a=>{const d=c.dataset.id;if(a.target.nodeName==="BUTTON"||a.target.nodeName==="use"||a.target.nodeName==="svg"){const u=t.find(m=>m._id===d);S(u),qt(d,!0)}else B(d)})}),K.append(e)}function qt(t,o){const e=K.querySelector(`[data-id="${t}"]`);if(!e)return;e.children[1].children[1].children[1].children[0].children[0].setAttribute("href",`${f}#${o?"icon-check":"icon-white-basket"}`)}const E=JSON.parse(localStorage.getItem("userEmailsArray"))||[],Q=document.querySelector(".footer-form"),X=document.querySelector(".wrong-email-footer"),Y=document.querySelector(".footer-modal-w-success"),Z=document.querySelector(".footer-modal-w-failure"),v=Q.querySelector("input[type=email]"),Ct=Q.querySelector("button[type=submit]"),Pt=document.querySelector(".footer-close-success-margin"),_t=document.querySelector(".footer-close-failure-margin"),Ft=document.querySelector(".footer-close-email-margin"),y=document.querySelector(".modal-section"),It=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);Ct.addEventListener("click",function(t){t.preventDefault();const o=v.value;if(!It(o)){v.value="",X.classList.add("visibility"),y.classList.add("modal-subscribing-footer");return}Bt()});const Tt=()=>{const t=v.value;E.includes(t)?(v.value="",Z.classList.add("visibility"),y.classList.add("modal-subscribing-footer")):(E.push(t),console.log("Users who have already subscribed:",E),localStorage.setItem("userEmailsArray",JSON.stringify(E)))},Bt=async()=>{try{const t="https://food-boutique.b.goit.study/api/subscription";Tt();const o={email:`${v.value}`},e=await l.post(t,o);Y.classList.add("visibility"),y.classList.add("modal-subscribing-footer"),v.value=""}catch(t){console.error("Error sending request:",t.message)}};_t.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),Z.classList.remove("visibility")});Ft.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),X.classList.remove("visibility")});Pt.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),Y.classList.remove("visibility")});const D=document.querySelector(".footer-modal-w-img"),At=768;function tt(){window.innerWidth<=At?D.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle-mobile.png?raw=true":D.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle.png?raw=true"}tt();window.addEventListener("resize",tt);const Mt="https://food-boutique.b.goit.study/api/products/popular",et=document.querySelector(".carts-popular"),x=document.createElement("h2");x.classList.add("popular-product-title");x.textContent="Popular products";et.appendChild(x);const H=document.createElement("ul");H.classList.add("popular-product-list");et.appendChild(H);function xt(t){if(!t)return console.error("Помилка"),null;const o=w(t._id),e=document.createElement("li");e.classList.add("product-preview"),e.setAttribute("data-id",t._id),o?e.classList.add("product-preview--in-cart"):e.classList.remove("product-preview--in-cart");const s=document.createElement("button");return s.onclick=n=>{n.stopPropagation(),w(t._id)?T(t._id):S(t)},s.className="product-preview__cart-btn",s.innerHTML=`
    <svg>
      <use href="${f}#${o?"icon-check":"icon-cart"}">
      </use>
    </svg>`,e.innerHTML=`
    <div class="product-preview__image-container">
      <img src="${t.img}" alt="${t.name}">
    </div>
    <div class="product-preview__info">
      <div class="product-preview__heading-wrapper">
        <h2 class="product-preview__heading">${t.name}</h2>
      </div>
      <div class="product-preview__description">
        <p class="product-preview__category"><span class="product-preview__sub-heading">Category:</span> ${t.category}</p>
        <p><span class="product-preview__sub-heading">Size:</span> ${t.size}</p>
        <p><span class="product-preview__sub-heading">Popularity:</span> ${t.popularity}</p>
      </div>
    </div>
  `,e.children[1].children[0].appendChild(s),e.onclick=()=>{B(t._id)},e}async function Ht(){try{return(await l.get(Mt)).data}catch(t){throw console.error("Помилка при отриманні даних: ",t),t}}document.addEventListener("DOMContentLoaded",async()=>{try{const t=await Ht();console.log(t),t.sort((o,e)=>e.popularity-o.popularity).forEach(o=>{const e=xt(o);e&&H.appendChild(e)})}catch(t){console.error("Помилка при отриманні даних: ",t)}});
//# sourceMappingURL=commonHelpers.js.map
