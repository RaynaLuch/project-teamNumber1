import{r as T,a as k,f as w,i as f}from"./assets/manage-cart-52b4aebc.js";import{a as d,P as tt,S as et}from"./assets/vendor-cb0d5946.js";const ot="https://food-boutique.b.goit.study/api",$=document.querySelector("[data-modal-close]"),st=document.querySelector("[data-modal]"),r=document.querySelector(".modal-cart-button");function q(){st.classList.toggle("is-hidden")}const z=document.querySelector("#modal-img"),O=document.querySelector("#modal-name"),it=document.querySelector("#modal-category"),nt=document.querySelector("#modal-size"),rt=document.querySelector("#modal-popularity"),ct=document.querySelector("#modal-desc"),at=document.querySelector("#modal-price");async function B(t){let o;try{let i=function(){r.removeEventListener("click",s),r.removeEventListener("click",e),$.removeEventListener("click",i),document.removeEventListener("keyup",n),q()},n=function(c){c.keyCode===27&&(q(),r.removeEventListener("click",s),r.removeEventListener("click",e),document.removeEventListener("keyup",n),$.removeEventListener("click",i))};o=await d(ot+"/products/"+t),console.log(o),z.src=o.data.img,O.textContent=o.data.name,z.alt=O.textContent,it.textContent=o.data.category,nt.textContent=o.data.size,rt.textContent=o.data.popularity,ct.textContent=o.data.desc,at.textContent="$"+o.data.price,q();const e=c=>{const a=o.data;T(a._id),r.removeEventListener("click",e),r.firstChild.textContent="Add to",r.addEventListener("click",s)},s=c=>{const a=o.data;k(a),r.removeEventListener("click",s),r.firstChild.textContent="Remove from",r.addEventListener("click",e)};w(o.data._id)?(r.firstChild.textContent="Remove from",r.addEventListener("click",e)):(r.firstChild.textContent="Add to",r.addEventListener("click",s)),$.addEventListener("click",i),document.addEventListener("keyup",n)}catch(e){console.log(e)}}const C=document.querySelector("[data-modal-close-shopping-cart]"),g=document.querySelector("[data-modal-shopping-cart]");C==null||C.addEventListener("click",N);function N(){g.classList.toggle("is-hidden")}const P=document.querySelector(".order-btn");P==null||P.addEventListener("click",()=>N());g==null||g.addEventListener("keypress",D);function D(t){t.keyCode===27&&(N(),g==null||g.removeEventListener("keypress",D))}function lt(t){return`<ul class="card-container-list">${t.map(e=>{const s=e.category.split("_").join(" ");return`
      <li class="photo-card-list" data-id="${e._id}">
        <a class="product-modal-list" href="#">
          <div class="img-container-list">
            <img class="product-image-list" src="${e.img}" alt="${e.name} photo" width=140 height=140 loading="lazy" />
          </div>

          <div class="product-info-list">
            <h3 class="product-name-list">${e.name}</h3>
            <div class="product-atributes-list">
              <p class="atributes-info-list">
                <span class="atributes-list">Category:</span> ${s}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Size:</span> ${e.size}
              </p>
              <p class="atributes-info-list">
                <span class="atributes-list">Popularity:</span> ${e.popularity}
              </p>
            </div>
          </div>
        </a>
        <div class="price-and-btn-list">
          <p class="product-price-list">$${e.price}</p>
          <button class="cart-btn-list" type="button" data-product-id="${e._id}">
            <svg class="list-cart-svg-list" width="18" height="18">
              <use href="${f}#icon-white-basket"></use>
            </svg>
          </button>
        </div> 
      </li>
  `}).join("")}</ul>`}function dt(t){document.querySelectorAll(".cart-btn-list").forEach(o=>{o.addEventListener("click",e=>{e.stopPropagation();const s=e.currentTarget.dataset.productId,i=t.find(c=>c._id===s);w(s)?(T(s),I(s)):(k(i),I(s))})})}function I(t){const o=document.querySelector(`[data-product-id='${t}']`);if(!o)return;w(t)?o.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${f}#icon-check"></use>
        </svg>
      `:o.innerHTML=`
        <svg class="list-cart-svg-list" width="18" height="18">
          <use href="${f}#icon-white-basket"></use>
        </svg>
      `}function ut(){document.querySelectorAll(".photo-card-list").forEach(o=>{o.addEventListener("click",e=>{e.preventDefault(),B(o.dataset.id)})})}const _=document.querySelector("#myBtn");function J(){document.body.scrollTop>20||document.documentElement.scrollTop>20?_.style.display="block":_.style.display="none",_.addEventListener("click",pt)}function pt(){window.scroll({top:0,left:0,behavior:"smooth"})}window.onscroll=J;window.onload=J;const mt=document.getElementById("products-container");let b,U=window.innerWidth<768?2:4;function gt(t,o){return d.get("https://food-boutique.b.goit.study/api/products",{params:{page:t,limit:o}})}function E(){const t=localStorage.getItem("productFilters");return t?JSON.parse(t):{keyword:null,category:null,page:1,limit:6}}function ft(t){localStorage.setItem("productFilters",JSON.stringify(t))}function F(t,o){const e=E();e[t]=o,ft(e)}window.addEventListener("resize",vt);function vt(){let t;window.innerWidth>=1440?t=9:window.innerWidth>=768?t=8:t=6,E().limit!==t&&(F("limit",t),U=window.innerWidth<768?2:4,A())}async function A(){const t=E();let o=t.page||1,e=t.limit||6;try{const{data:s}=await gt(o,e),{perPage:i,totalPages:n,results:c}=s,a=i*n;mt.innerHTML=lt(c),dt(c),ut();const p=document.getElementById("tui-pagination-container");b?(b.reset(a),b.movePageTo(o)):(b=new tt(p,{totalItems:a,itemsPerPage:e,visiblePages:U,centerAlign:!0,page:o}),b.on("beforeMove",u=>{const m=u.page,h=E(),H=h.limit||6;(m!==h.page||H!==h.limit)&&(F("page",m),F("limit",H),A())})),I()}catch(s){console.error("Error fetching products",s)}}A();const W=document.querySelector(".carts-discount");async function yt(){const{data:t}=await d.get("https://food-boutique.b.goit.study/api/products/discount");return t.sort(()=>Math.random()-.5).slice(0,2)}ht();async function ht(){const t=await yt(),o=t.map(({img:c,is10PercentOff:a,price:p,name:u,_id:m})=>{const h=u.split("").slice(0,11).join("")+"...";return`<li data-id="${m}"class="dis-product-card"><img class="dis-product-img" src="${c}" alt="${u}"/><div class="dis-card-description"><p class="dis-card-name">${u.split("").length>11?h:u}</p><div class="price-btn-list">
        <p class="product-price-list">$${p}</p>
        <button class="cart-btn-list" type="button" data-product-id="${m}">
          <svg class="list-cart-svg-list" width="18" height="18">
            <use href="${f}#icon-white-basket"></use>
          </svg></button>
      </div></div></div>${a?`<svg class="discount-icon"><use href="${f}#icon-discount"></use></svg>`:null}</li>`}).join(""),e=document.createElement("div");e.classList.add("dis-container");const s=document.createElement("h2");s.classList.add("discount-title"),s.innerText="Discount products";const i=document.createElement("ul");i.classList.add("discount-list"),i.innerHTML=o,e.append(s),e.append(i),i.querySelectorAll(".dis-product-card").forEach(c=>{c.addEventListener("click",a=>{const p=c.dataset.id;if(a.target.nodeName==="BUTTON"||a.target.nodeName==="use"||a.target.nodeName==="svg"){const u=t.find(m=>m._id===p);k(u),bt(p,!0)}else B(p)})}),W.append(e)}function bt(t,o){const e=W.querySelector(`[data-id="${t}"]`);if(!e)return;e.children[1].children[1].children[1].children[0].children[0].setAttribute("href",`${f}#${o?"icon-check":"icon-white-basket"}`)}const L=JSON.parse(localStorage.getItem("userEmailsArray"))||[],R=document.querySelector(".footer-form"),V=document.querySelector(".wrong-email-footer"),G=document.querySelector(".footer-modal-w-success"),K=document.querySelector(".footer-modal-w-failure"),v=R.querySelector("input[type=email]"),wt=R.querySelector("button[type=submit]"),Lt=document.querySelector(".footer-close-success-margin"),Et=document.querySelector(".footer-close-failure-margin"),St=document.querySelector(".footer-close-email-margin"),y=document.querySelector(".modal-section"),kt=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t);wt.addEventListener("click",function(t){t.preventDefault();const o=v.value;if(!kt(o)){v.value="",V.classList.add("visibility"),y.classList.add("modal-subscribing-footer");return}qt()});const $t=()=>{const t=v.value;L.includes(t)?(v.value="",K.classList.add("visibility"),y.classList.add("modal-subscribing-footer")):(L.push(t),console.log("Users who have already subscribed:",L),localStorage.setItem("userEmailsArray",JSON.stringify(L)))},qt=async()=>{try{const t="https://food-boutique.b.goit.study/api/subscription";$t();const o={email:`${v.value}`},e=await d.post(t,o);G.classList.add("visibility"),y.classList.add("modal-subscribing-footer"),v.value=""}catch(t){console.error("Error sending request:",t.message)}};Et.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),K.classList.remove("visibility")});St.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),V.classList.remove("visibility")});Lt.addEventListener("click",function(t){y.classList.remove("modal-subscribing-footer"),G.classList.remove("visibility")});const j=document.querySelector(".footer-modal-w-img"),Ct=768;function Q(){window.innerWidth<=Ct?j.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle-mobile.png?raw=true":j.src="https://github.com/RaynaLuch/project-teamNumber1/blob/main/src/img/rectangle.png?raw=true"}Q();window.addEventListener("resize",Q);const Pt="https://food-boutique.b.goit.study/api/products/popular",X=document.querySelector(".carts-popular"),M=document.createElement("h2");M.classList.add("popular-product-title");M.textContent="Popular products";X.appendChild(M);const x=document.createElement("ul");x.classList.add("popular-product-list");X.appendChild(x);function _t(t){if(!t)return console.error("Помилка"),null;const o=w(t._id),e=document.createElement("li");e.classList.add("product-preview"),e.setAttribute("data-id",t._id),o?e.classList.add("product-preview--in-cart"):e.classList.remove("product-preview--in-cart");const s=document.createElement("button");return s.onclick=i=>{i.stopPropagation(),w(t._id)?T(t._id):k(t)},s.className="product-preview__cart-btn",s.innerHTML=`
    <svg>
      <use href="${f}#${o?"icon-check":"icon-cart"}">
      </use>
    </svg>`,e.innerHTML=`
    <div class="product-preview__image-container">
      <img src="${t.img}" alt="${t.name}">
    </div>
    <div class="product-preview__info">
      <div class="product-preview__heading-wrapper">
        <h2 class="product-preview__heading">${t.name}</h2>
      </div>
      <div class="product-preview__description">
        <p class="product-preview__category"><span class="product-preview__sub-heading">Category:</span> ${t.category}</p>
        <p><span class="product-preview__sub-heading">Size:</span> ${t.size}</p>
        <p><span class="product-preview__sub-heading">Popularity:</span> ${t.popularity}</p>
      </div>
    </div>
  `,e.children[1].children[0].appendChild(s),e.onclick=()=>{B(t._id)},e}async function It(){try{return(await d.get(Pt)).data}catch(t){throw console.error("Помилка при отриманні даних: ",t),t}}document.addEventListener("DOMContentLoaded",async()=>{try{const t=await It();console.log(t),t.sort((o,e)=>e.popularity-o.popularity).forEach(o=>{const e=_t(o);e&&x.appendChild(e)})}catch(t){console.error("Помилка при отриманні даних: ",t)}});const Y=document.querySelector(".filters-select"),Ft=document.querySelector(".filtersInput"),Tt=document.querySelector(".filtersBtn");let S;const l={keyword:null,category:null,page:1,limit:9};localStorage.setItem("filterParams",JSON.stringify(l));async function Bt(){try{return(await d.get("https://food-boutique.b.goit.study/api/products/categories")).data}catch(t){throw console.log("Проблема при запросе на сервер"),new Error(t)}}async function Z(t){const{keyword:o,category:e,page:s,limit:i}=t;try{let n;return o===null&&e===null?n=await d.get(`https://food-boutique.b.goit.study/api/products?page=${s}&limit=${i}`):o===null?n=await d.get(`https://food-boutique.b.goit.study/api/products?category=${e}&page=${s}&limit=${i}`):e===null?n=await d.get(`https://food-boutique.b.goit.study/api/products?keyword=${o}&page=${s}&limit=${i}`):n=await d.get(`https://food-boutique.b.goit.study/api/products?keyword=${o}&category=${e}&page=${s}&limit=${i}`),n.data.results}catch(n){throw console.log("Помилка на сервері при пошуку продуктів",n),new Error(n)}}async function Nt(){try{const o=(await Bt()).map(e=>`<option>${e}</option>`).join("")+"<option>Show all</option>";Y.insertAdjacentHTML("beforeend",o),new et({select:".filters-select"})}catch(t){console.log("Проблема при обработке данных с сервера",t)}}Nt();Y.addEventListener("change",At);Tt.addEventListener("click",Mt);async function At(t){l.category=t.currentTarget.value,l.category==="Show all"?l.category=null:localStorage.setItem("filterParams",JSON.stringify(l)),S=await Z(l),console.log(S)}async function Mt(){const t=Ft.value;t.trim()?l.keyword=t:l.keyword=null,localStorage.setItem("filterParams",JSON.stringify(l)),S=await Z(l),console.log(S)}
//# sourceMappingURL=commonHelpers.js.map
